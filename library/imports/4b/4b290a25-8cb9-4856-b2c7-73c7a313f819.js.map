{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "AAAA,EAAE,CAAC,KAAK,CAAC;AACL,eAAS,EAAE,CAAC,SAAS;;AAErB,cAAU,EAAE;AACR,uBAAe,EAAE;AACb,uBAAS,IAAI;AACb,eAAG,EAAE,EAAE,CAAC,SAAS;SACpB;AACD,iBAAS,EAAE;AACP,uBAAS,IAAI;AACb,eAAG,EAAE,EAAE,CAAC,SAAS;SACpB;AACD,gBAAQ,EAAE;AACN,uBAAS,IAAI;AACb,eAAG,EAAE,EAAE,CAAC,SAAS;SACpB;AACD,wBAAgB,EAAE;AACd,uBAAS,IAAI;AACb,gBAAI,EAAE,EAAE,CAAC,MAAM;SAClB;AACD,wBAAgB,EAAE;AACd,uBAAS,IAAI;AACb,gBAAI,EAAE,EAAE,CAAC,MAAM;SAClB;AACD,gBAAQ,EAAE,KAAK;AACf,uBAAe,EAAE,EAAE;AACnB,oBAAY,EAAE,CAAC;AACf,oBAAY,EAAE,CAAC;KAClB;;;AAGD,UAAM,EAAE,kBAAY;AAChB,YAAI,CAAC,gBAAgB,EAAE,CAAC;AACxB,YAAI,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;KAChD;;AAED,gBAAY,EAAE,sBAAS,CAAC,EAAE;AACtB,UAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;AAC1C,YAAI,CAAC,SAAS,CAAC,EAAE,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAC1C,UAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC;AACvD,UAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC;AACnE,UAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,YAAY,GAAG,IAAI,CAAC,CAAC,CAAC;AAC7D,UAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,YAAY,GAAG,IAAI,CAAC,CAAC,CAAC;KAChE;;AAED,UAAM,EAAE,gBAAS,CAAC,EAAE;AAChB,YAAG,CAAC,CAAC,MAAM,KAAK,IAAI,CAAC,IAAI,EAAE;AACvB,gBAAI,CAAC,SAAS,CAAC,EAAE,CAAC,OAAO,CAAC,GAAG,EAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACrC,cAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,QAAQ,GAAG,KAAK,CAAC;SAC3D,MAAM;AACH,cAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;SAC5C;KACJ;;AAED,SAAK,EAAE,eAAS,CAAC,EAAE;AACf,YAAI,IAAI,GAAG,IAAI;YACX,QAAQ,GAAG,EAAC,CAAC,EAAE,IAAI,CAAC,YAAY,EAAE,CAAC,EAAE,IAAI,CAAC,YAAY,EAAC;YACvD,QAAQ,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,QAAQ;;AAC1D,uBAAe,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,eAAe;;AACxE,qBAAa,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,cAAc,CAAC,eAAe,CAAC;;AACjE,mBAAW,GAAG,IAAI,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;YAC7D,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;;;AAG/B,gBAAQ,CAAC,SAAS,CAAC,WAAW,EAAE,UAAS,KAAK,EAAE;;AAC5C,gBAAI,MAAM,GAAG,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;gBACnC,MAAM,GAAG,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;;AAExC,gBAAG,MAAM,IAAI,MAAM,IAAI,QAAQ,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;;AAC9C,oBAAG,aAAa,EAAE;AACd,iCAAa,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;AACxD,sBAAE,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;AAChD,4BAAQ,CAAC,SAAS,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;AACjC,wBAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;iBACxC;aACJ;SACJ,CAAC,CAAC;KACV;;AAED,kBAAc,EAAE,wBAAS,QAAQ,EAAE;AAC/B,YAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACnC,gBAAQ,CAAC,SAAS,CAAC,QAAQ,EAAE,UAAS,KAAK,EAAE;AACzC,oBAAQ,CAAC,SAAS,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;SACnC,CAAC,CAAC;KACN;;;AAGD,oBAAgB,EAAE,4BAAW;AACzB,YAAI,IAAI,GAAG,IAAI;YACX,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC;YAC9B,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACnC,aAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,CAAC,EAAE,CAAC,EAAE,EAAE;AAClB,gBAAI,KAAK,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAC5B,CAAC,GAAG,KAAK,CAAC,CAAC;gBACX,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;;AAEhB,gBAAG,CAAC,KAAK,CAAC,OAAO,EAAE;AACf,oBAAG,KAAK,CAAC,KAAK,IAAI,OAAO,EAAE;AACvB,wBAAI,QAAQ,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;AACrD,wBAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;AAC7B,4BAAQ,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC3B,4BAAQ,CAAC,IAAI,GAAG,YAAY,GAAC,CAAC,CAAC;AAC/B,sBAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,EACnD,QAAQ,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;iBAC1D,MAAM;AACH,wBAAI,QAAQ,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;AACrD,wBAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;AAC7B,4BAAQ,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC3B,4BAAQ,CAAC,IAAI,GAAG,YAAY,GAAC,CAAC,CAAC;AAC/B,sBAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,EACnD,QAAQ,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;iBAC1D;aACJ;SACJ;KACJ;;AAED,aAAS,EAAE,mBAAS,EAAE,EAAE;AACpB,YAAI,IAAI,GAAG,IAAI;YACX,QAAQ,GAAG,KAAK,CAAC;AACrB,UAAE,CAAC,EAAE,CAAC,YAAY,EAAE,CAAA,YAAW;AAC3B,gBAAI,WAAW,GAAG,EAAE,CAAC,OAAO,CAAC,GAAG,EAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AAC3C,gBAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;SAC/B,CAAA,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;KACf;AACD,eAAW,EAAE,uBAAW;AACpB,YAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC;YAC9B,CAAC,GAAG,QAAQ,CAAC,YAAY,EAAE;YAC3B,CAAC,GAAG,QAAQ,CAAC,YAAY,EAAE;YAC3B,QAAQ,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AAChD,YAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;AAC7B,eAAO,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAClB,gBAAQ,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;KAC9B;;AAED,UAAM,EAAE,kBAAW,EAElB;CACJ,CAAC,CAAC",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        backgroundAudio: {\n            default: null,\n            url: cc.AudioClip\n        },\n        pickAudio: {\n            default: null,\n            url: cc.AudioClip\n        },\n        putAudio: {\n            default: null,\n            url: cc.AudioClip\n        },\n        blackChessPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        whiteChessPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        moveAble: false,\n        movingChessName: \"\",\n        oldPositionX: 0,\n        oldPositionY: 0\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.initChessToPoint();\n        this.node.on(\"touchstart\", this.onPut, this);\n    },\n\n    onTouchStart: function(e) {\n        cc.find('Canvas').emit('pick', this.name);\n        this.runAction(cc.scaleTo(0.1, 1.2, 1.2));\n        cc.find('Canvas').getComponent('main').moveAble = true;\n        cc.find('Canvas').getComponent('main').movingChessName = this.name;\n        cc.find('Canvas').getComponent('main').oldPositionX = this.x;\n        cc.find('Canvas').getComponent('main').oldPositionY = this.y;\n    },\n\n    onPick: function(e) {\n        if(e.detail !== this.name) {\n            this.runAction(cc.scaleTo(0.1,1, 1));\n            cc.find('Canvas').getComponent('main').moveAble = false;\n        } else {\n            cc.find('Canvas').emit('put', this.name);\n        }\n    },\n\n    onPut: function(e) {\n        let that = this,\n            oldPoint = {x: that.oldPositionX ,y: that.oldPositionY},\n            moveAble = cc.find('Canvas').getComponent('main').moveAble,   // 是否可移动\n            movingChessName = cc.find('Canvas').getComponent('main').movingChessName,   // 可移动的棋子 name\n            moveChessNode = cc.find('Canvas').getChildByName(movingChessName),  // 可移动棋子的节点\n            targetPoint = this.node.convertToNodeSpaceAR(e.getLocation()),\n            pointMgr = require('pointMgr');\n\n            // cc.log(oldPoint);\n            pointMgr.isInpoint(targetPoint, function(index) {   // 传递目标坐标，如果在已定义的点范围内则返回该已定义点的索引\n                let pointX = pointMgr.getPoint(index).x, \n                    pointY = pointMgr.getPoint(index).y;\n                // cc.log(pointX, pointY)\n                if(pointX && pointY && pointMgr.getStatus(index)) { // 判断是否有棋子，坐标是否存在\n                    if(moveChessNode) {\n                        moveChessNode.runAction(cc.moveTo(0.1, pointX, pointY));   // 根据事件传过来的目标点做移动\n                        cc.audioEngine.playEffect(that.putAudio, false);\n                        pointMgr.setStatus(index, false);     // 设置该位置已占用\n                        that.setOldPosition(oldPoint, index);\n                    }\n                }\n            });\n    },\n\n    setOldPosition: function(oldPoint) {\n        let pointMgr = require('pointMgr');\n        pointMgr.isInpoint(oldPoint, function(index) {\n            pointMgr.setStatus(index, true);        // 设置已移除棋子位置的状态\n        });\n    },\n\n    // 初始化放置棋子到默认位置\n    initChessToPoint: function() {\n        let that = this,\n            pointMgr = require('pointMgr'),\n            chessMgr = require('chessMgr');\n        for(let i=0;i<8; i++) {\n            let point = pointMgr.getPoint(i), \n                x = point.x, \n                y = point.y;\n            // chessMgr.move(x, y);\n            if(!point.isEmpty) {\n                if(point.color == 'white') {\n                    let newChess = cc.instantiate(this.whiteChessPrefab);\n                    that.node.addChild(newChess);\n                    newChess.setPosition(x, y);\n                    newChess.name = 'whiteChess'+i;\n                    cc.find('Canvas').on('pick', that.onPick, newChess),\n                    newChess.on('touchstart', that.onTouchStart, newChess);\n                } else {\n                    let newChess = cc.instantiate(this.blackChessPrefab);\n                    that.node.addChild(newChess);\n                    newChess.setPosition(x, y);\n                    newChess.name = 'whiteChess'+i;\n                    cc.find('Canvas').on('pick', that.onPick, newChess),\n                    newChess.on('touchstart', that.onTouchStart, newChess);\n                }\n            } \n        }\n    },\n    // 棋子移动\n    chessMove: function(el) {\n        let that = this,\n            isMoving = false;\n        el.on('touchstart', function() {\n            var scaleAction = cc.scaleBy(0.1,1.5, 1.5);\n            this.runAction(scaleAction);\n        }.bind(el));\n    },\n    addNewChess: function() {\n        let chessMgr = require('chessMgr'),\n            x = chessMgr.getPositionX(),\n            y = chessMgr.getPositionY(),\n            newChess = cc.instantiate(this.chessPrefab);\n        this.node.addChild(newChess);\n        console.log(x, y);\n        newChess.setPosition(x, y);\n    },\n\n    update: function() {\n\n    }\n});\n"
  ]
}